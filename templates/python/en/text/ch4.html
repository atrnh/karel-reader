<h1>Chapter 4: Decomposition</h1>
<hr/>
<p>
  As a way of illustrating more of the power that comes with being able to define new functions, it’s useful to have Karel do something a little more practical than move a beeper from one place to another. The roadways often seem to be in need of repair, and it might be fun to see if Karel can fill potholes in its abstract world. For example, imagine that Karel is standing on the “road” shown in the left-hand figure, one corner to the left of a pothole in the road. Karel’s job is to fill the hole with a beeper and proceed to the next corner. The diagram on the right illustrates how the world should look after the program execution.
</p>

<%
  include('templates/python/'+lang+'/programs/beforeAfter.html', name="ba", before="pothole", after="potholeGoal", ratio="0.82", canvasWidth="300", customDescriptionBefore="There are walls around row 1 column 1 and in a rectangle near the bottom right corner around the positions in row 1 columns 3, 4, and 5.", customDescriptionAfter="There are walls around row 1 column 1 and in a rectangle near the bottom right corner around the positions in row 1 columns 3, 4, and 5.")
%>

<p>
If you are limited to the four predefined commands, the <code>main()</code> function to solve this problem would look like this:
</p>

<p style="margin-left:2em">
  <code><span class="keyword">def</span> main():</code><br/>
    <code style="margin-left:2em">move()</code><br/>
    <code style="margin-left:2em">turn_left()</code><br/>
    <code style="margin-left:2em">turn_left()</code><br/>
    <code style="margin-left:2em">turn_left()</code><br/>
    <code style="margin-left:2em">move()</code><br/>
    <code style="margin-left:2em">put_beeper()</code><br/>
    <code style="margin-left:2em">turn_left()</code><br/>
    <code style="margin-left:2em">turn_left()</code><br/>
    <code style="margin-left:2em">move()</code><br/>
    <code style="margin-left:2em">turn_left()</code><br/>
    <code style="margin-left:2em">turn_left()</code><br/>
    <code style="margin-left:2em">turn_left()</code><br/>
    <code style="margin-left:2em">move()</code><br/>
</p>

<p>
The initial motivation for defining the <code>turn_right()</code> function was that it was cumbersome to keep repeating three <code>turn_left()</code> commands to accomplish a right turn. Defining new functions has another important purpose beyond allowing you to avoid repeating the same command sequences every time you want to perform a particular task. The power to define functions unlocks the most important strategy in programming—the process of breaking a large problem down into smaller pieces that are easier to solve. The process of breaking a program down into smaller pieces is called <b>decomposition</b>, and the component parts of a large problem are called <b>subproblems</b>.
</p>

<p>
  As an example, the problem of filling the hole in the roadway can be decomposed into the following subproblems:
</p>

<ol>
<li> Move up to the hole
<li> Fill the hole by dropping a beeper into it
<li> Move on to the next corner
</ol>

<p>
  If you think about the problem in this way, you can use function definitions to create a program that reflects your conception of the program structure. The main function would look like this:
  </p>

<p style="margin-left:2em">
<code><span class="keyword">def</span> main():</code><br/>
   <code style="margin-left:2em">move()</code><br/>
   <code style="margin-left:2em">fill_pothole()</code><br/>
   <code style="margin-left:2em">move()</code><br/>
</p>

<p>
The correspondence with the outline is immediately clear, and everything would be great if only you could get Karel to understand what you mean by <code>fill_pothole()</code>. Given the power to define functions, implementing <code>fill_pothole()</code> is extremely simple. All you have to do is define a <code>fill_pothole()</code> function whose body consists of the commands you have already written to do the job, like this:
</p>

<p style="margin-left:2em">
<code><span class="keyword">def</span> fill_pothole():</code><br/>
   <code style="margin-left:2em">turn_right()</code><br/>
   <code style="margin-left:2em">move()</code><br/>
   <code style="margin-left:2em">put_beeper()</code><br/>
   <code style="margin-left:2em">turn_around()</code><br/>
   <code style="margin-left:2em">move()</code><br/>
   <code style="margin-left:2em">turn_right()</code><br/>
</p>

<p>
Here is the complete program. Notice how you can understand the programmer's intent simply from reading the <code>main()</code> function. When you run the program, the line highlighting shows how a computer will execute it, step by step. However, because the program is nicely broken down we can understand it on a human thought level:
</p>

<%
  include('templates/python/'+lang+'/programs/runnable.html', name="pothole", world="pothole", canvasWidth=200, customDescription="There are walls around row 1 column 1 and in a rectangle near the bottom right corner around the positions in row 1 columns 3, 4, and 5.")
%>
